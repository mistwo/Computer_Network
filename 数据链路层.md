# 数据链路层

## 使用点对点信道的数据链路层

### 数据链路和帧

- 数据链路 ！= 链路

	- 链路 link

		- 一个结点到相邻结点的一段物理线路

	- 数据链路 data link

		- 一段物理线路，以及必要的通信协议用以控制数据传输
		- 用 网络适配器 实现这些协议

			- 一般包括数据链路层和物理层

- 协议 又称 规程 procedure

	- 数据链路层协议数据单元：帧

		- 网络层协议数据单元：IP数据报

- 不必考虑物理层如何实现比特传输的细节。甚至可以想象双方数据链路层在水平方向“直接”把帧发送给对方

### 三个基本问题

- 封装成帧 framing

	- 在数据前后分别添加首部和尾部

		- 帧界定

			- ASCII 帧界定符

				- SOH
				- EOT

	- 数据部分长度上限——最大传送单元MTU

- 透明传输

	- 透明：一个存在的事物看起来就像不存在一样
	- 字节填充/字符填充

		- 插入转义字符ESC

			- 十六进制 1B
			- 二进制 00011011

- 差错检测

	- 0和1变化了

		- 比特差错
		- 错误比特所占比率：误码率 BER

	- 循环冗余检测 CRC

		- 数据k位+冗余码n位

			- 传输后，再做除法

				- 余数得0，则无差错，接收 accept
				- 不等于0，则丢弃

		- 无差错接收（不是 可靠传输）

			- 即 凡是接收端数据链路层接收的帧，我们都能以非常接近于1的概率认为这些帧在传输过程中没有产生差错
			- 传输差错（不是 比特差错）

				- 帧丢失
				- 帧重复
				- 帧失序

		- 必须向上提供可靠传输

			- 帧编号
			- 帧确认
			- 帧重传

		- 在数据后面添加的冗余码，称为帧检验序列 FCS

## 点对点协议PPP

### 特点

- point-to-point protocol 目前最流行的数据链路层协议
- PPP协议就是用户计算机和ISP进行通信时所使用的数据链路层协议
- 应满足的需求

	- 简单

		- 提高互操作性

	- 封装成帧

		- 帧界定符

	- 透明性
	- 多种网络层协议

		- 同一物理链路上同时支持多种网络层协议

	- 多种类型链路
	- 差错检测 error detection

		- 立即丢弃有差错的帧

	- 检测连接状态

		- 自动检测

	- 最大传送单元

		- MTU默认值

	- 网络层地址协商
	- 数据压缩协商

- PPP协议的组成

	- 一个将IP数据报封装到串行链路的方法
	- 一个用来建立、配置和测试数据链路连接的链路控制协议LCP
	- 一套网络控制协议NCP

### PPP协议的帧格式

- 各字段的意义

	- 首部

		- 标志字段 F

			- 7E

		- A

			- FF

		- C

			- 03

		- 协议

			- 2字节

	- 尾部

		- FCS
		- F

			- 7E

- 实现透明传输

	- 字节填充

		- 0x7E

			- 0x7D, 0x5E

		- 0x7D

			- 0x7D, 0x5E

		- ASCII码的控制字符

			- 前面加入0x7D

	- 零比特填充

		- 情况：同步传输

			- 连续6个1：01111110 标志字段F

		- 先扫描整个信息字段，连续5个1，则在后面插入一个0

	- 不适用序号和确认机制？

		- 出错概率小
		- 不能保证网络层传输也是可靠的
		- FCS字段保证无差错接受

### PPP协议的工作状态

- 子主题 1

*XMind: ZEN - Trial Version*